(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6291],{7942:(e,t,a)=>{"use strict";a.d(t,{Zo:()=>c,kt:()=>h});var n=a(959);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(a),m=r,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||i;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9428:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h});var n=a(959),r=a(6233),i=a(4838),o=a(2232),s=a(2441),l=a(6361);const p={container:"container_KHaM",panel:"panel_p8cl",editor:"editor_LjJP",response:"response_Ger1",tool:"tool_nUFu",notool:"notool_i7V8"},c=e=>{e.getWrapperElement().closest(".graphiql-editor").style.height=`${e.doc.height}px`};function u(e){const{queryEditor:t,variableEditor:a,headerEditor:r}=(0,l._i)({nonNull:!0}),[i,o]=(0,n.useState)(e.defaultTab),s=(0,l.Xd)({onCopyQuery:e.onCopyQuery}),u=(0,l.fE)();return(0,n.useEffect)((()=>{a&&c(a)}),[i,a]),(0,n.useEffect)((()=>{r&&c(r)}),[i,r]),(0,n.useEffect)((()=>{t&&(t.setOption("lineNumbers",!1),t.setOption("extraKeys",{"Alt-G":()=>{t.replaceSelection("@")}}),t.setOption("gutters",[]),t.on("change",c),c(t))}),[t]),(0,n.useEffect)((()=>{a&&(a.setOption("lineNumbers",!1),a.setOption("gutters",[]),a.on("change",c))}),[a]),(0,n.useEffect)((()=>{r&&(r.setOption("lineNumbers",!1),r.setOption("gutters",[]),r.on("change",c))}),[r]),n.createElement("div",{className:"graphiql-editors"},n.createElement("section",{className:"graphiql-query-editor","aria-label":"Query Editor"},n.createElement("div",{className:"graphiql-query-editor-wrapper"},n.createElement(l.WK,{editorTheme:e.editorTheme,keyMap:e.keyMap,onCopyQuery:e.onCopyQuery,onEdit:e.onEditQuery,readOnly:e.readOnly})),n.createElement("div",{className:"graphiql-toolbar",role:"toolbar","aria-label":"Editor Commands"},n.createElement(l._8,null),n.createElement(l.wC,{onClick:()=>u(),label:"Prettify query (Shift-Ctrl-P)"},n.createElement(l.Kt,{className:"graphiql-toolbar-icon","aria-hidden":"true"})),n.createElement(l.wC,{onClick:()=>s(),label:"Copy query (Shift-Ctrl-C)"},n.createElement(l.TI,{className:"graphiql-toolbar-icon","aria-hidden":"true"})))),n.createElement("div",{className:"graphiql-editor-tools"},n.createElement("div",{className:"graphiql-editor-tools-tabs"},n.createElement(l.v0,{type:"button",className:"variables"===i?"active":"",onClick:()=>{o("variables"===i?"":"variables")}},"Variables"),n.createElement(l.v0,{type:"button",className:"headers"===i?"active":"",onClick:()=>{o("headers"===i?"":"headers")}},"Headers"))),n.createElement("section",{className:`graphiql-editor-tool ${i&&i.length>0?p.tool:p.notool}`,"aria-label":"variables"===i?"Variables":"Headers"},n.createElement(l.hF,{editorTheme:e.editorTheme,isHidden:"variables"!==i,keyMap:e.keyMap,onEdit:e.onEditVariables,readOnly:e.readOnly}),n.createElement(l.LA,{editorTheme:e.editorTheme,isHidden:"headers"!==i,keyMap:e.keyMap,onEdit:e.onEditHeaders,readOnly:e.readOnly})))}class d{constructor(){this.map=new Map,this.length=0}getItem(e){return this.map.get(e)}setItem(e,t){this.map.has(e)||(this.length+=1),this.map.set(e,t)}removeItem(e){this.map.has(e)&&(this.length-=1),this.map.delete(e)}clear(){this.length=0,this.map.clear()}}function m(){return(0,l.JB)({nonNull:!0}).isFetching?n.createElement(l.$j,null):null}function h(e){let{typegraph:t,query:a,code:c,codeLanguage:h,codeFileUrl:y,headers:g={},variables:f={},tab:b=""}=e;const{siteConfig:{customFields:{tgUrl:k}}}=(0,o.Z)(),v=(0,n.useMemo)((()=>new d),[]);return n.createElement(i.Z,{fallback:n.createElement("div",null,"Loading...")},(()=>{const e=(0,n.useMemo)((()=>(0,r.nq)({url:`${k}/${t}`})),[]);return n.createElement(l.j$,{fetcher:e,defaultQuery:a.loc.source.body.trim(),defaultHeaders:JSON.stringify(g),variables:JSON.stringify(f),storage:v},n.createElement("div",{className:"mb-6"},n.createElement("div",{className:`graphiql-container ${p.container}`},c?n.createElement("div",{className:`graphiql-response ${p.panel}`},n.createElement(s.Z,{language:h},c)):null,n.createElement("div",{className:`graphiql-session ${p.editor}`},n.createElement(u,{defaultTab:b})),n.createElement("div",{className:`graphiql-response ${p.response}`},n.createElement(m,null),n.createElement(l.iB,null))),y?n.createElement("small",{className:"mx-2"},"See/edit full code on"," ",n.createElement("a",{href:`https://github.com/metatypedev/metatype/blob/main/${y}`},y)):null))}))}},3191:(e,t,a)=>{"use strict";a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=a(1163),r=(a(959),a(7942)),i=a(2441);a(9428);const o={sidebar_position:2,comments:!1},s="Typegraph",l={unversionedId:"concepts/typegraph/index",id:"concepts/typegraph/index",title:"Typegraph",description:"Typegraph is a Python package for building virtual graphs of types and managing their metadata. The name also refers to the typegraph specification which is a file format, currently in JSON, describing all elements of a typegraph.",source:"@site/docs/concepts/typegraph/index.mdx",sourceDirName:"concepts/typegraph",slug:"/concepts/typegraph/",permalink:"/docs/concepts/typegraph/",draft:!1,editUrl:"https://github.com/metatypedev/metatype/tree/main/website/docs/concepts/typegraph/index.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,comments:!1},sidebar:"docs",previous:{title:"Overview",permalink:"/docs/concepts/overview/"},next:{title:"Typegate",permalink:"/docs/concepts/typegate/"}},p={},c=[{value:"Types",id:"types",level:2},{value:"Materializers",id:"materializers",level:2},{value:"Runtimes",id:"runtimes",level:2},{value:"Policies",id:"policies",level:2},{value:"Triggers",id:"triggers",level:2}],u={toc:c},d="wrapper";function m(e){let{components:t,...o}=e;return(0,r.kt)(d,(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"typegraph"},"Typegraph"),(0,r.kt)("p",null,"Typegraph is a ",(0,r.kt)("a",{parentName:"p",href:"https://pypi.org/project/typegraph/"},"Python package")," for building virtual graphs of types and managing their metadata. The name also refers to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/specification"},"typegraph specification")," which is a file format, currently in JSON, describing all elements of a typegraph."),(0,r.kt)("admonition",{title:"Why Python?",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Python was historically chosen during Metatype's prototyping phase and remained since then the default way to describe typegraphs. Its great readability and dynamic typing make it a very accessible language for everyone to pick up quickly."),(0,r.kt)("p",{parentName:"admonition"},"In theory, all frameworks and languages can produce typegraphs respecting the specification to become executable by typegates. This opens the door to a wide range of use cases, including generating typegraphs automatically from existing code base and tools.")),(0,r.kt)("h2",{id:"types"},"Types"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Types")," are the building block of typegraphs. They define a type system describing all data objects processed in Metatype. They can be easily extended to support new data types according to the needs of the application."),(0,r.kt)(i.Z,{language:"python",mdxType:"CodeBlock"},a(3187).content),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Analogy in SQL"),": types are similar to the Data Definition Language (DDL) with the extended capacity of describing any type of data."),(0,r.kt)("h2",{id:"materializers"},"Materializers"),(0,r.kt)("p",null,"Types can also describe functions and ",(0,r.kt)("strong",{parentName:"p"},"materializers")," define how the input type gets transformed into the output type. The input and output types are similar to a function signature and a materializer to its implementation, except that it might not always know what the function body is. In such case, the materializer knows at least where and how to access it."),(0,r.kt)(i.Z,{language:"python",mdxType:"CodeBlock"},a(8331).content),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Analogy in SQL"),": a materializer is similar to a join, a function, or an alias."),(0,r.kt)("h2",{id:"runtimes"},"Runtimes"),(0,r.kt)("p",null,"Every type and materializer have a runtime associated to it. This runtime describes where the types or materializers are physically located. It can be another API, a database, or any other services the typegate can connect to. The typegates uses that information to optimize the execution of the queries and minimize the amount of data moved."),(0,r.kt)("p",null,"In practice, materializers are often not explicitly used and the usage of runtime sugar syntax is preferred."),(0,r.kt)(i.Z,{language:"python",mdxType:"CodeBlock"},a(961).content),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Analogy in SQL"),": a runtime is similar to a database instance running some requests."),(0,r.kt)("h2",{id:"policies"},"Policies"),(0,r.kt)("p",null,"Policies are a special type of function ",(0,r.kt)("inlineCode",{parentName:"p"},"t.func(t.struct({...}), t.boolean().optional())")," attachable to any other type. They are evaluated once per request and determine whether one of the polices authorizes the access or not. They receive the request context (see ",(0,r.kt)("a",{parentName:"p",href:"./typegate"},"typegate"),") as argument allowing you to implement authorization, access control, or any other business logic."),(0,r.kt)("p",null,"The policy decision can be:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"true"),": the access is authorized"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"false"),": the access is denied"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"null"),": the access in inherited from the parent types")),(0,r.kt)(i.Z,{language:"python",mdxType:"CodeBlock"},a(6799).content),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Analogy in SQL"),": policies are similar to Row Security Policies (RSP) or Row Level Security (RLS) concepts."),(0,r.kt)("h2",{id:"triggers"},"Triggers"),(0,r.kt)("p",null,"Triggers are events launching the execution of one or multiple functions. They fire when a GraphQL request is received for the specific typegraph."),(0,r.kt)(i.Z,{language:"python",mdxType:"CodeBlock"},a(1682).content),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Analogy in SQL"),": a trigger is similar to receiving a new query."))}m.isMDXComponent=!0},8331:e=>{e.exports={content:'t.func(\n  t.struct({"input": t.string()}),\n  t.string(),\n  PureFunMat("({ input }) => `hello ${input}`"),  # with logic\n)\n\nt.func(\n  t.struct({}),\n  t.enum(["head", "tail"]),\n  RESTMat(http, "GET", "/flip_coin", effect=effects.none),  # where the logic is\n)',path:"website/docs/concepts/typegraph/functions.py"}},6799:e=>{e.exports={content:'public = Policy(PureFunMat("() => true"))\nteam_only = Policy(PureFunMat("(ctx) => ctx.user.role === \'admin\'"))',path:"website/docs/concepts/typegraph/policies.py"}},961:e=>{e.exports={content:'http = HTTPRuntime("https://random.org/api")\n\n# same func as above\nhttp.get(\n  "/flip_coin", t.struct({}), t.enum(["head", "tail"])\n)  # implicitly attaches runtime to all types',path:"website/docs/concepts/typegraph/runtimes.py"}},1682:e=>{e.exports={content:'with TypeGraph("triggers") as g:\n  # ...\n  g.expose(\n    flip=http.get("/flip_coin", t.struct({}), t.enum(["head", "tail"])),\n    default_policy=[public],\n  )',path:"website/docs/concepts/typegraph/triggers.py"}},3187:e=>{e.exports={content:'t.struct(\n  {\n    "id": t.uuid(),\n    "age": t.integer(),\n    "cars": t.array(\n      t.struct(\n        {\n          "model": t.string(),\n          "name": t.string().optional(),\n        }\n      )\n    ),\n  }\n)',path:"website/docs/concepts/typegraph/types.py"}}}]);